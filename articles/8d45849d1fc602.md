---
title: "Gatsbyã«ã‚ªãƒ¬ã‚ªãƒ¬è¨­å®šã§å…¥é–€ã—ã¦ã¿ãŸ"
emoji: "ğŸ™ˆ"
type: "tech"
topics:
  - "gatsby"
  - "react"
  - "typescript"
published: true
published_at: "2020-12-07 01:49"
---

ãšã£ã¨é–‹ç™ºã—ã¦ããŸNuxtãŒã‚¤ãƒ¤ã«ãªã‚Šã€é›°å›²æ°—ãŒä¼¼ã¦ã‚‹Nextã«å…¥é–€ã—ã¦ã¿ãŸã‘ã©åˆ¥ã«Vercelã«ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ã¤ã‚‚ã‚Šãªã„ã—ãªâ€¦ã¨æ€ã£ã¦Gatsbyã«ã‚‚å…¥é–€ã—ã¦ã¿ã¾ã—ãŸ

ã€Œä»Šã¾ã§Nextã§é–‹ç™ºã—ã¦ããŸã‘ã©Gatsbyã£ã¦ã©ã‚“ãªã‚“ãªã‚“ã ã‚ã†ã€ã£ã¦æ°—ã«ãªã£ã¦ã‚‹ã‚¢ãƒŠã‚¿ã®åŠ©ã‘ã«ãªã‚ŒãŸã‚‰å¹¸ã„ã§ã™

# ã¨ã‚Šã‚ãˆãšnewã—ã¦ã¿ã‚‹
ï½·ï¾ï½¬ï¾‚ï¾‹ï¾ï½°ã®ï½·ï¾ï½¬ã®å­—ã‚‚çŸ¥ã‚‰ãªã„çŠ¶æ…‹ã‹ã‚‰ã€ã¾ãšCLIã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™
```sh
$ npm i -g gatsby-cli
```
`gatsby` ã‚³ãƒãƒ³ãƒ‰ãŒä½¿ãˆã‚‹ã‚ˆã†ã«ãªã£ãŸã‚‰
```sh
$ gatsby new hello-gatsby
$ cd hello-gatsby
$ npm run develop
```
ã“ã‚Œã§ [localhost:8000](http://localhost:8000) ã§å‹•ã„ã¦ã„ã¾ã™

# import React from 'react'
Nextå‹¢ãŒæœ€åˆã«é¡”ã‚’ã—ã‹ã‚ãã†ãªãƒã‚¤ãƒ³ãƒˆ(?)ã§ã™ãŒã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã« `.babelrc` ã‚’ç½®ãã“ã¨ã§Gatsbyã®babelè¨­å®šã‚’ã‚«ã‚¹ã‚¿ãƒ ã§ãã¾ã™
`npm i -D babel-plugin-react-require` ã—ã¦
```json:.babelrc
{
  "plugins": [
    "react-require"
  ],
  "presets": [
    [
      "gatsby",
      {
        "targets": {}
      }
    ]
  ]
}
```
ã‚’è¿½åŠ ã—ã¾ã—ã‚‡ã†
(ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®è©³ç´°: [babel-plugin-react-require](https://www.npmjs.com/package/babel-plugin-react-require))
(å‚è€ƒ: [Babel | Gatsby](https://www.gatsbyjs.com/docs/babel/))

# Path Alias
babelã¤ã„ã§ã«Path Aliasã®è¨­å®šã‚’ã—ã¾ã™
`npm i -D babel-plugin-module-resolver` ã—ãŸã‚‰ `plugins` ã«ä»¥ä¸‹ã®ã‚ˆã†ã«è¿½åŠ ã—ã¾ã™

```json:.babelrc > plugins
"module-resolver", {
  "alias": {
    "@": "./src"
  }
}
```

å€‹äººçš„ã«ã¯ `src` ã‚’ `@` ã«ã—ã¦ãŠãã®ãŒå¥½ãã§ã™
ã„ã¤ã‚‚ã“ã‚Œ

# TypeScript
ãã‚Œãªã‚Šã«ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’å‹•ã‹ã™ãªã‚‰TypeScriptã¯å¿…é ˆã£ã¦ãŠå¹´é ƒãªã®ã§ã€ã¨ã«ã‹ãJSãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¸€æƒã—ã¾ã™
*å†’é ­ã§è§¦ã‚ŒãŸ Nuxt (Vue/Vuex) ãŒã‚¤ãƒ¤ã«ãªã£ãŸç†ç”±ã‚‚TypeScriptã¨ã®ç›¸æ€§ã®æ‚ªã•ãŒåŸå› ã ã£ãŸã‚Šã—ã¾ã™*

æ‹¡å¼µå­ã‚’æ›¸ãæ›ãˆã¦å‹å®šç¾©ã‚’ã—ã¦ã„ãã¾ã™
GraphQLã®å‹ãŒåˆè¦‹ã«ã¯å°‘ã€…ãƒˆãƒªãƒƒã‚­ãƒ¼ã§ã€ãƒãƒƒãƒˆã«ã‚‚ã‚ã‚“ã¾ã‚Šæƒ…å ±ãŒãªã•ãã†ãªã®ã§ã€ã‚ˆã‹ã£ãŸã‚‰[ç§ã®ãƒªãƒã‚¸ãƒˆãƒª](https://github.com/tomon9086/gatsby-boilerplate/tree/a0c8b8485441daa821f96a2f75594dedb8dbf005)ã‚’å‚ç…§ã—ã¦ã¿ã¦ãã ã•ã„
ãŸã¶ã‚“æ­£ã—ã„ã¨æ€ã„ã¾ã™

`tsconfig.json` ã¯Nextã§ä½¿ã£ã¦ãŸç§˜ä¼ã®ã‚¿ãƒ¬ãŒã‚ã‚‹ã®ã§ãã®ã¾ã¾ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ
**æ³¨æ„**
Babelã«Path Aliasã‚’è¨­å®šã—ãŸæ–¹ã¯ã€ã“ã“ã§TypeScriptã«ã‚‚è¨­å®šã—ãªã„ã¨ã‚¨ãƒ‡ã‚£ã‚¿ã«æ€’ã‚‰ã‚Œã¾ã™
`compilerOptions` ã«ä»¥ä¸‹ã®ã‚ˆã†ã«è¿½åŠ ã—ã¦ãã ã•ã„
```json:tsconfig.json > compilerOptions
"baseUrl": ".",
"paths": {
  "@/*": ["./src/*"]
}
```
---
æœ€åˆã®é …ã§èµ·å‹•ã—ãŸãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ã‚‚ã‚ã‚‹ã®ã§ã™ãŒã€
![Gatsby supports TypeScript by default!](https://storage.googleapis.com/zenn-user-upload/a79is6f0ai86p67iijdqbugpqxlo)
Gatsbyã¯ `pages` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãªã‚“ã‹ã«ç›´æ¥ `.tsx` ã‚’ç½®ã„ã¦ã‚‚å‹•ã„ã¦ãã‚Œã‚‹ã‚‰ã—ã„ã®ã§ã€`tsconfig.json` ã¯ãªãã¦ã‚‚å‹•ããã†

ã§ã‚‚ã‚ã‚‹ã‚‚ã®ã¯ç½®ã„ã¨ã“ã†ã‹ãªã£ã¦â€¦

ç½®ãå ´åˆã¯ `typescript` ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãŒå¿…è¦ã¿ãŸã„ã§ã™
(å‚è€ƒ: [Gatsby.jsã®TypeScriptåŒ– 2020](https://zenn.dev/ryo_kawamata/articles/gatsby-ts-2020#1.-tsconfig.json%E3%81%AE%E8%BF%BD%E5%8A%A0))

# Formatter
æ¬¡ã«ç›®ã«ç•™ã¾ã‚‹ã®ãŒã€`.prettierrc`
ã„ã¾ã¾ã§ Nuxt, Next ã¨ã‚³ãƒ¼ãƒ‰ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã¯ESLintã«ã‚„ã‚‰ã›ã¦ããŸã®ã§ã€ã¾ãŸæ–°ã—ãç§˜ä¼ã®ã‚¿ãƒ¬ã‚’æ›¸ãç›´ã—ãŸãã¯ã‚ã‚Šã¾ã›ã‚“

Prettierã•ã‚“ã«ã¯ãŠå¼•å–ã‚Šã„ãŸã ã„ã¦ã€ESLintã•ã‚“ã‚’å¬å–šã—ã¾ã—ã‚‡ã†
ã“ã‚Œã‚‚ãªã‚“ã¦ã“ã¨ã¯ãªã„ã€Nextã®é ƒã® `.eslintrc.js` ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãŸã¡ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã ã‘ã§ç‰¹åˆ¥æ›¸ãæ›ãˆã‚‹ã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“

ã‚‚ã—autofixãŒå‹•ã‹ãªã„ã‚ˆã†ã§ã‚ã‚Œã°ESLintã®ã‚¨ãƒ©ãƒ¼ã‚’èª­ã¿ã¾ã—ã‚‡ã†ã€è¶³ã‚Šãªã„ã‚‚ã®ãŒã‚ã‚‹ã‹ã‚‚
VSCode (mac) ãªã‚‰â‡§âŒ˜Uã§ `OUTPUT` ã‚’é–‹ã„ã¦å³ã®ãƒ—ãƒ«ãƒ€ã‚¦ãƒ³ã‹ã‚‰ESLintã‚’é¸ã¶ã¨èª­ã‚ã¾ã™

ã¡ãªã¿ã«å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«ã‚‚ESLintã§ã®è¨­å®šæ‰‹é †ãŒã‚ã‚‹ã®ã§ã™ãŒã€ã‚¬ãƒ³ç„¡è¦–ã—ã¦ã„ã¾ã™
(ã‚ˆã‹ã£ãŸã‚‰ã©ã†ã: [Using ESLint | Gatsby](https://www.gatsbyjs.com/docs/eslint/))

# CSS Modules ã‚’ä½¿ã„ãŸã„
Nextã§ä½¿ã£ã¦ã„ãŸCSS Modulesã‚’ä½¿ã„ãŸã„ã§ã™ã‚ˆã­(åœ§)
CSS Modulesã¯å…¬å¼pluginãŒã‚ã‚Šã¾ã™
`npm i -D gatsby-plugin-react-css-modules` ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ `plugins` ã«è¿½åŠ ã—ã¾ã—ã‚‡ã†

```js:gatsby-config.js > plugins
{
  resolve: 'gatsby-plugin-react-css-modules'
},
```

(å‚è€ƒ: [gatsby-plugin-react-css-modules | Gatsby](https://www.gatsbyjs.com/plugins/gatsby-plugin-react-css-modules/))

# Global CSS
CSS Modulesã‚’ä½¿ã†ã‹ã©ã†ã‹ã«é–¢ã‚ã‚‰ãšã‚°ãƒ­ãƒ¼ãƒãƒ«ãªCSSã‚’æ›¸ãå ´æ‰€ã¯ã»ã—ã„ã®ã§ã¯ãªã„ã§ã—ã‚‡ã†ã‹
`src/styles` ã« `global.css` ã‚’ä½œã£ã¦ã€ `gatsby-browser.js` ã«ä»¥ä¸‹ã‚’è¿½è¨˜ã—ã¾ã—ã‚‡ã†

```js:gatsby-browser.js
import '@/styles/global.css'
// Path AliasãŒãªã„å ´åˆã¯
// import './src/styles/global.css'
```

# SCSS ã‚’ä½¿ã„ãŸã„
## CSS Modules
`npm i -D postcss-scss` ã—ã¦ã€ä¸Šã§è¿½åŠ ã—ãŸ `plugin` ã® `option` ã« `.scss` ã‚’è¿½åŠ ã—ã¾ã—ã‚‡ã†

```js:gatsby-config.js > plugins
{
  resolve: 'gatsby-plugin-react-css-modules',
  options: {
    filetypes: {
      '.scss': { syntax: 'postcss-scss' }
    }
  }
},
```

## Global CSS
å…¬å¼pluginã«Sassã«å¯¾å¿œã™ã‚‹ãŸã‚ã®å…¬å¼pluginãŒã‚ã‚Šã¾ã™
`npm i -D node-sass gatsby-plugin-sass` ã—ã¦ã€ã¾ãŸ `plugin` ã«è¿½åŠ ã—ã¾ã—ã‚‡ã†

```js:gatsby-config.js > plugins
'gatsby-plugin-sass',
```

(å‚è€ƒ: [gatsby-plugin-sass | Gatsby](https://www.gatsbyjs.com/plugins/gatsby-plugin-sass/))

---
ä¸€æ™‚çš„ãªã‚‚ã®ã ã¨ã¯æ€ã„ã¾ã™ãŒã€ç§ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸã¨ãã¯ `node-sass` ã¨ `gatsby-plugin-sass` ã§ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒåˆã„ã¾ã›ã‚“ã§ã—ãŸ
ã‚¨ãƒ©ãƒ¼ãŒå‡ºãŸå ´åˆã¯ `gatsby-plugin-sass` ã«åˆã‚ã›ã¦ `node-sass` ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ç›´ã—ã¦ãã ã•ã„
ä¾‹ãˆã°ã€ãƒãƒ¼ã‚¸ãƒ§ãƒ³ `4.14.1` ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸã„ã¨ãã¯ `npm i -D node-sass@4.14.1` ã¨ã—ã¾ã™

# yarnã‚’ä½¿ã„ãŸã„
Gatsby CLIãŒãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’newã™ã‚‹ã¨ãä¾å­˜é–¢ä¿‚ã‚‚å‹æ‰‹ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ãã‚Œã‚‹ã®ã§ã™ãŒã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã ã¨npmã‚’ä½¿ã†ã®ã§ã€ã“ã‚Œã‚’yarnã«å¤‰ãˆã¾ã™
```json:~/.config/gatsby/config.json
ï¸™
  "cli": {
    "packageManager": "yarn"
  },
ï¸™
```
ã“ã‚Œã ã‘ï¼

(å‚è€ƒ: [Yarn | Gatsby](https://www.gatsbyjs.com/docs/glossary/yarn/))

# ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆåŒ–ã—ã‚ˆã†
Gatsbyã®ã„ã„ã¨ã“ã‚ã¯ã€è‡ªåˆ†ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒªãƒã‚¸ãƒˆãƒªã‹ã‚‰ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œã‚Œã‚‹ã¨ã“ã‚ã§ã™ã‚ˆã­
ã‚ªãƒ¬ã‚ªãƒ¬è¨­å®šã‚’ä½œã£ãŸã‚‰ `Repository > Setting > Template repository` ã®ãƒã‚§ãƒƒã‚¯ã‚’å…¥ã‚Œã¾ã—ã‚‡ã†

![Check Template repository Setting](https://storage.googleapis.com/zenn-user-upload/qbwfan4meor1j8wagrji7k17urcz =300x)

ã“ã‚Œã§ã‚‚ã†
```sh
$ gatsby new my-gatsby-project https://github.com/tomon9086/gatsby-boilerplate
```
ã¨ã€ã‚„ã‚‹ã ã‘ã§ã‚ªãƒ¬ã‚ªãƒ¬è¨­å®šã®Gatsbyãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãŒnewã•ã‚Œã‚‹ã£ã¦ãƒ¯ã‚±ã§ã™ï¼
ã¡ãªã¿ã«ã“ã‚Œã¯ç§ã®ãƒœã‚¤ãƒ©ãƒ¼ãƒ—ãƒ¬ãƒ¼ãƒˆã§ã™ ã‚ˆã‹ã£ãŸã‚‰ä½¿ã£ã¦ã­

# Nextã‚„Nuxtã¨ã®é•ã„ã¯ï¼Ÿ
å…¬å¼ãŒæ¯”è¼ƒã‚’å‡ºã—ã¦ã„ã‚‹ã®ã§ç§ã¯ãƒªãƒ³ã‚¯ã‚’è²¼ã‚‹ã ã‘ã§ã™ã­
- [Gatsby vs Next](https://www.gatsbyjs.com/features/jamstack/gatsby-vs-nextjs)
- [Gatsby vs Nuxt](https://www.gatsbyjs.com/features/jamstack/gatsby-vs-nuxtjs)

# ã‚ã¨ãŒã
å…¬å¼ã‚µã‚¤ãƒˆã§pluginã‚’æ¤œç´¢ã§ãã‚‹ã¨ã“ã‚ã‹ã‚‰è¦‹ã¦ã‚‚ã€ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºæ€§ã‚’é‡è¦–ã—ãŸãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ãªã®ã‹ãªã€ã¨ã„ã†å°è±¡ã‚’å—ã‘ã¾ã—ãŸ
æ¬¡ã¯SSR/SSGã®ä½¿ã„å‹æ‰‹ã‚’Nextã¨æ¯”ã¹ã¦ã¿ãŸã„ã¨æ€ã„ã¾ã™ (è¨˜äº‹ã‚’æ›¸ãã‹ã¯æ°—åˆ†æ¬¡ç¬¬)

ã‚ã¨ã€HMRãŒNuxtã‚„Nextã‚ˆã‚Šã‚‚é€Ÿã„ã‹ã‚‚ï¼Ÿ æ°—ã®ã›ã„ã‹ã‚‚ã—ã‚Œãªã„ã§ã™ãŒ
