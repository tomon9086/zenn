---
title: "Firebase Functionsã«PubSubã‚¤ãƒ™ãƒ³ãƒˆã‚’è¿½åŠ ã—ãŸã‚‰ãƒ‡ãƒ—ãƒ­ã‚¤ãŒé€šã‚‰ãªããªã£ãŸ"
emoji: "â°"
type: "tech"
topics:
  - "firebase"
  - "cloudfunctions"
  - "pubsub"
  - "cloudscheduler"
published: true
published_at: "2021-04-11 12:50"
---

Cloud Functions for Firebase ã§ã€ä»Šã¾ã§HTTPã‚¤ãƒ™ãƒ³ãƒˆã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã§ãã¦ã„ãŸã®ã«PubSubã‚¤ãƒ™ãƒ³ãƒˆã‚’è¿½åŠ ã—ãŸé€”ç«¯ `Functions did not deploy properly.` ã¨è¨€ã‚ã‚Œã‚‹ã‚ˆã†ã«ãªã£ã¦ã—ã¾ã£ãŸ

# TL; DR
[Cloud Scheduler](https://console.cloud.google.com/cloudscheduler) ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦æ‰‹å‹•ã§PubSubã‚¸ãƒ§ãƒ–ã‚’ä½œã‚‹ã¨ç›´ã‚‹ã€ä»¥é™ã®ãƒ‡ãƒ—ãƒ­ã‚¤ã‚‚è½ã¡ãªããªã‚‹

# èª¿æŸ»
PubSubã‚¤ãƒ™ãƒ³ãƒˆã‚’å«ã‚ä¸€è¦‹ã™ã¹ã¦æˆåŠŸã—ã¦ã„ã¦ã€ä½•åº¦ãƒªãƒˆãƒ©ã‚¤ã—ã¦ã‚‚ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹

```log
Functions deploy had errors with the following functions:
	<PubSubé–¢æ•°å>(us-central1)
```
ã¨ã‚ã‚‹ã®ã§PubSubã«ãªã«ã‹å•é¡ŒãŒã‚ã‚Šãã†

ã‚ˆãã‚ã‹ã‚‰ãªã„ã®ã§ verbose ã—ãŸ
```sh
$ firebase deploy --only "functions:<PubSubé–¢æ•°å>" --debug
```
:::message
ãŠã›ã£ã‹ã„ã‚’è¨€ã†ã¨ã€ãƒ­ã‚°ãŒçµæ§‹ãŸãã•ã‚“å‡ºã‚‹ã®ã§
```sh
$ firebase deploy --only "functions:<PubSubé–¢æ•°å>" --debug >> ~/Desktop/debug.log
```
ã¨ã‹ã™ã‚‹ã¨ãƒ•ã‚¡ã‚¤ãƒ«ã«ãªã£ã¦ä¾¿åˆ©
:::
ãƒ­ã‚°ã‚’ `error` ã§æ¤œç´¢ã™ã‚‹ã¨ã€
```json
{
  "error": {
    "code": 404,
    "message": "The project <firebase-project> does not contain an App Engine application. Please visit https://console.developers.google.com/appengine?project=<firebase-project> to to add an App Engine application.",
    "status": "NOT_FOUND",
    "details": [
      {
        "@type": "type.googleapis.com/google.rpc.Help",
        "links": [
          {
            "description": "Create App Engine application",
            "url": "https://console.developers.google.com/appengine?project=<firebase-project>"
          }
        ]
      }
    ]
  }
}
```
ã“ã‚“ãªãƒ¬ã‚¹ãƒãƒ³ã‚¹ãŒè¦‹ã¤ã‹ã£ãŸ
éå»ã«åŒã˜ã‚ˆã†ãªæ§‹æˆã§ä½œã£ãŸãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãŒã‚ã£ãŸãŒã€ãã£ã¡ã«ã‚‚ App Engine ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã¯ä½œã‚‰ã‚Œã¦ã„ãªã„ã— `firebase-tools` ã®ãƒã‚°ã‹ãªï¼Ÿã¨æ€ã£ãŸãŒã€ãŸã—ã‹ã«æŒ‡å®šã—ãŸæ™‚åˆ»ã«ãªã£ã¦ã‚‚é–¢æ•°ãŒå‹•ã‹ãªã„
ãã“ã§è©¦ã—ã« [Cloud Functions](https://console.cloud.google.com/functions) ã‹ã‚‰å®Ÿè¡Œã™ã‚‹ã¨å‹•ã„ãŸ

# ğŸ’¡
[Cloud Scheduler](https://console.cloud.google.com/cloudscheduler) ã‹ã‚‰æ‰‹å‹•ã§PubSubã‚¸ãƒ§ãƒ–ã‚’ä½œã£ã¦ã¿ã‚‹
:::message
Firebaseã«ã‚ˆã£ã¦ä½œã‚‰ã‚Œã‚‹PubSubã¯åå‰ãƒ»ãƒˆãƒ”ãƒƒã‚¯ã¨ã‚‚ã« `firebase-schedule-<PubSubé–¢æ•°å>-us-central1` ã¨ã„ã†å½¢å¼ã«ãªã‚‹
ãŸã¶ã‚“ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã¯ãªã‚“ã§ã‚‚ã„ã„ã®ã§è‡ªåˆ†ã¯ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã«ã‚‚ã“ã‚Œã‚’å…¥åŠ›ã—ãŸ (ãŸã¶ã‚“ `hoge` ã§ã‚‚å‹•ã)
ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³ã¨é »åº¦ã¯ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã«è¨˜è¿°ã—ãŸã‚‚ã®ã¨æƒãˆã‚‹
:::

æŒ‡å®šæ™‚åˆ»ã«å‹•ãã‚ˆã†ã«ãªã‚Šã€ä»¥é™ã®ãƒ‡ãƒ—ãƒ­ã‚¤ã‚‚ã‚¨ãƒ©ãƒ¼ã‚’åã‹ãªããªã£ãŸ

# ãŸã¶ã‚“
Cloud Scheduler ã¯ App Engine ã®ç®¡è½„ ([APIã¨ã‚µãƒ¼ãƒ“ã‚¹](https://console.cloud.google.com/apis/dashboard) çš„ãªæ„å‘³ã§) ãªã®ã§ã€ãã®ã¸ã‚“ã®ã‚¢ãƒ¬ã§ App Engine ã®ã‚¨ãƒ©ãƒ¼ãŒå‡ºã¦ãŸã‚“ã ã‚ã†
ä»¥å‰ã¯ã“ã‚“ãªã“ã¨ã—ãªãã¦ã‚‚åˆå›ã‹ã‚‰ãƒ‡ãƒ—ãƒ­ã‚¤ã§ãã¦ãŸã¨æ€ã†ã‚“ã ãŒã€ãŸã¾ã«GCPãŒå‹˜é•ã„ã—ã¡ã‚ƒã†ã®ã‹ã‚‚ã—ã‚Œãªã„
