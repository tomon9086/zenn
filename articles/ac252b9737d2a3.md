---
title: "Flutterã®mapbox_glã§ã‚¢ãƒ—ãƒªãŒã‚¯ãƒ©ãƒƒã‚·ãƒ¥ã™ã‚‹å•é¡Œ"
emoji: "ğŸ’£"
type: "tech"
topics:
  - "flutter"
  - "ios"
  - "mapbox"
published: true
published_at: "2021-09-04 21:23"
---

Flutterå‘ã‘éå…¬å¼mapboxãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®[mapbox_gl](https://pub.dev/packages/mapbox_gl)ã‚’ä½¿ã£ã¦ã€iOSã§åœ°å›³ã‚’è¡¨ç¤ºã—ã‚ˆã†ã¨ã™ã‚‹ã¨ã‚¢ãƒ—ãƒªãŒã‚¯ãƒ©ãƒƒã‚·ãƒ¥ã™ã‚‹å•é¡Œã«ã¤ã„ã¦è§£æ±ºã—ãŸã®ã§ãƒ¡ãƒ¢ã§ã™ã€‚

Androidã®è¨­å®šã§å›°ã£ã¦ã„ã‚‹æ–¹ã¯[ã“ã¡ã‚‰](https://zenn.dev/tomon9086/articles/6d9f1c9a69ca1c)ã€‚

# TL; DR
``` diff xml:ios/Runner/info.plist
  <?xml version="1.0" encoding="UTF-8"?>
  <!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
  <plist version="1.0">
  <dict>
    <key>CFBundleDevelopmentRegion</key>
    <string>$(DEVELOPMENT_LANGUAGE)</string>
    ï¸™
+   <key>NSLocationWhenInUseUsageDescription</key>
+   <string>Shows your location on the map and helps improve the map</string>
  </dict>
  </plist>
```

# å‰æã¨çŠ¶æ³
- Flutter SDK 2.12.0
- mapbox_gl æœªãƒªãƒªãƒ¼ã‚¹ç‰ˆ (commit: `f90d54`) [^1]
- iOS 14.5 (Simulator)

Flutterã®ãƒ‡ãƒãƒƒã‚°ãƒ­ã‚°ã«ã¯ä½•ã‚‚è¡¨ç¤ºã•ã‚Œãšã€ãŸã ã‚³ãƒã‚¯ã‚·ãƒ§ãƒ³ãŒãƒ­ã‚¹ãƒˆã—ã¦ã„ã¦ã€Simulatorã®ã‚·ã‚¹ãƒ†ãƒ ãƒ­ã‚°ã‚’è¦‹ã¦ã‚‚ `SIGABRT` ã§è½ã¡ã¦ã„ã‚‹ã¨ã„ã†ã“ã¨ã—ã‹ã‚ã‹ã‚Šã¾ã›ã‚“ã€‚
```
com.apple.CoreSimulator.SimDevice.F631AA84-64DE-452F-A732-506E538347CB[9006] (UIKitApplication:com.example.MyApp[ce87][rb-legacy][42004]): Service exited due to SIGABRT
```

# èª¿æŸ»
[example](https://github.com/tobrun/flutter-mapbox-gl/tree/master/example) ã‚’å‹•ã‹ã—ãŸã‚‰å‹•ã„ãŸã®ã§ã€æ–°ã—ãä½œã£ãŸãƒŸãƒ‹ãƒãƒ«ãªãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¨ãƒ•ã‚¡ã‚¤ãƒ«å·®åˆ†ã‚’å–ã‚ŠãªãŒã‚‰ä½•ãŒè¶³ã‚Šãªã„ã®ã‹ã„ã‚ã„ã‚è©¦ã—ã¾ã—ãŸã€‚
ãã®çµæœ `info.plist` ãŒåŸå› ã§ã€exampleã§è¿½åŠ ã•ã‚Œã¦ã„ãŸã®ã¯ä»¥ä¸‹ã®5ã¤ã®é …ç›®ã§ã—ãŸã€‚
```xml:info.plist
<key>io.flutter.embedded_views_preview</key>
<true/>
<key>MGLMapboxAccessToken</key>
<string>YOUR_KEY_HERE</string>
<key>MGLMapboxMetricsEnabledSettingShownInApp</key>
<true/>
<key>NSLocationWhenInUseUsageDescription</key>
<string>Shows your location on the map and helps improve the map</string>
<key>NSLocationAlwaysUsageDescription</key>
<string>Shows your location on the map and helps improve the map</string>
```

ã•ã‚‰ã«çµã£ã¦ã„ãã¨ã€`NSLocationWhenInUseUsageDescription` ã•ãˆã‚ã‚Œã°å‹•ãã“ã¨ã‚‚ã‚ã‹ã‚Šã¾ã—ãŸã€‚

# æ„šç—´
ã•ã™ãŒã«ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«æ›¸ã„ã¦ã‚ã‚‹ã‚„ã‚ã¨æ€ã£ã¦ã€æ¢ã—ã¦ã¿ãŸã‚‰[NSLocationWhenInUseUsageDescriptionã«ã¤ã„ã¦ã®è¨˜è¿°](https://pub.dev/packages/mapbox_gl#ios)ã¯ã‚ã£ãŸã®ã§ã™ãŒã€

> To enable location features in an iOS application:
> If you access your users' location, you should also add the following key to `ios/Runner/Info.plist` 

ã£ã¦ã€å¿…é ˆã˜ã‚ƒãªã„ã¿ãŸã„ãªè¨€ã„æ–¹ã˜ã‚ƒãªã„ã§ã™ã‹ï¼Ÿ

æ¥ãšã‹ã—ãªãŒã‚‰ã“ã‚“ãªã“ã¨ã§æ•°æ—¥æº¶ã‹ã—ã¦ã€Google Mapã§å®Ÿè£…ã—ã‚ˆã†ã‹ãªã¨è«¦ã‚ã‹ã‘ãŸã‚Šã‚‚ã—ã¾ã—ãŸãŒã€è§£æ±ºã§ãã¦ã†ã‚Œã—ã„ã§ã™ğŸ˜ 

[^1]:nullableå¯¾å¿œç‰ˆãŒã¾ã ãƒªãƒªãƒ¼ã‚¹ã•ã‚Œã¦ã„ãªã„ã®ã§ã€`dependency_overrides` ã§masterãƒ–ãƒ©ãƒ³ãƒã‚’ä½¿ã£ã¦ã„ã¾ã™